# ACME Receipt OCR Web API

This demo project is a .NET Web API for customer services of company products. It consists of two main features:
1. **Product Code Generation**: Generates unique product codes for packaging.
2. **Receipt Parsing**: Parses receipt images to extract and organize text data.

## Table of Contents
- [Getting Started](#getting-started)
- [Testing](#testing)
- [Features](#features)
- [Usage](#usage)
- [API Endpoints](#api-endpoints)

## Getting Started

### Prerequisites
- [.NET SDK](https://dotnet.microsoft.com/download) installed on your machine.

### Installation
1. Restore the dependencies:
    ```bash
    dotnet restore
    ```

2. Build the project:
    ```bash
    dotnet build
    ```

3. Run the project:
    ```bash
    dotnet run
    ```


## Testing
This project uses an in-memory database and a mockup OCR third-party service for test purposes. It includes tests that you can run to verify the functionality.


## Features

### Product Code Generation
- Generates unique 8-character product codes with given char set.
- Avoids code guessing and hacking.

### Receipt Parsing
- Accepts receipt images.
- Uses third-party OCR service to parse receipt images into JSON format.
- Organizes and sorts extracted text based on bounding box coordinates.

## Usage

### Product Code Generation
- The service generates and stores unique product codes.
- Checks for duplicates and ensures uniqueness.

### Receipt Parsing
- Parses JSON response from OCR.

### Receipt Proccessor
- Groups words into lines based on bounding box coordinates.
- Orders lines by X and Y coordinates for accurate text representation.

## API Endpoints
### Product Code Endpoints

- **POST** `/api/ProductCodes/generate`
  - Generates a unique product code.
  - **Curl Example:**
    ```sh
    curl -X 'POST' \
      'https://localhost:7240/api/ProductCodes/generate' \
      -H 'accept: */*' \
      -d ''
    ```

  - **Response Body:**
    ```json
    {
      "result": "GTLHMRC9",
      "id": 177,
      "exception": null,
      "status": 5,
      "isCanceled": false,
      "isCompleted": true,
      "isCompletedSuccessfully": true,
      "creationOptions": 0,
      "asyncState": null,
      "isFaulted": false
    }
    ```

- **GET** `/api/ProductCodes/{code}/validate`
  - Validates if the given product code was generated by the service.
  - **Curl Example:**
    ```sh
    curl -X 'GET' \
      'https://localhost:7240/api/ProductCodes/GTLHMRC9/validate' \
      -H 'accept: */*'
    ```

  - **Response Body:**
    ```json
    true
    ```

### Receipt Endpoint
- **POST** `/api/receipts`
  - Accepts an image file (JPEG, PNG).
  - Returns parsed receipt data.
  - **Curl Example:**
    ```sh
    curl -X 'POST' \
    'https://localhost:7240/api/Receipts/parse' \
    -H 'accept: */*' \
    -H 'Content-Type: multipart/form-data' \
    -F 'file=@path_to_your_receipt_image.jpg'
    ```
